(this.webpackJsonpweather_app=this.webpackJsonpweather_app||[]).push([[0],{124:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(7),l=a.n(o),c=(a(96),a(22)),i=(a(97),a(44)),s=a(49),u=a.n(s);var m=a(150),h=a(157),d=a(19),p=a(33),E=a.n(p),g=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:"GET_ERRORS",payload:{msg:e,status:t,id:a}}},w=function(){return function(e,t){e({type:"USER_LOADING"}),E.a.get("/api/auth/user",f(t)).then((function(t){return e({type:"USER_LOADED",payload:t.data})})).catch((function(t){e(g(t.response.data,t.response.status)),e({type:"AUTH_ERROR"})}))}},b=function(){return{type:"LOGOUT_SUCCESS"}},f=function(e){var t=e().auth.token,a={headers:{"Content-type":"application/json"}};return t&&(a.headers["x-auth-token"]=t),a},v=function(){return{type:"ITEMS_LOADING"}},y=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,user:e.auth.user}}),{addItem:function(e){return function(t,a){E.a.post("/api/items",e,f(a)).then((function(e){return t({type:"ADD_ITEM",payload:e.data})})).catch((function(e){return t(g(e.response.data,e.response.status))}))}}})((function(e){var t=e.addItem,a=e.isAuthenticated,o=e.user,l=Object(n.useState)([]),s=Object(c.a)(l,2),d=s[0],p=s[1],E=Object(n.useState)([]),g=Object(c.a)(E,2),w=g[0],b=g[1],f=Object(n.useState)(""),v=Object(c.a)(f,2),y=v[0],_=v[1],O=Object(n.useState)([]),S=Object(c.a)(O,2),j=S[0],N=S[1],I=function(e,t){var a=Object(n.useState)(e),r=Object(c.a)(a,2),o=r[0],l=r[1];return Object(n.useEffect)((function(){var a=setTimeout((function(){l(e)}),t);return function(){clearTimeout(a)}}),[e,t]),o}(y,700);Object(n.useEffect)((function(){var e;I?(e=I,u.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.awrap(fetch("https://cors-anywhere.herokuapp.com/https://www.metaweather.com/api/location/search/?query=".concat(e)).then((function(e){return e.json()})).then((function(e){return b(e.slice(0,10))})).catch((function(e){console.error(e)})));case 2:case"end":return t.stop()}}))):b([])}),[I]),Object(n.useEffect)((function(){p([]);u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:Promise.all(w.map((function(e){return fetch("https://cors-anywhere.herokuapp.com/https://www.metaweather.com/api/location/".concat(e.woeid,"/")).then((function(e){return e.json()})).then((function(e){return p((function(t){return[].concat(Object(i.a)(t),[{res:e,showMoreStuff:!1}])}))})).catch((function(e){console.error(e)})),null})));case 1:case"end":return e.stop()}}))}),[w]);return console.log(w),r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"title"},"Weather"),o&&r.a.createElement("div",null,"You are logged in!"),r.a.createElement("div",null,r.a.createElement("input",{type:"text",value:y,onChange:function(e){_(e.target.value)},placeholder:"input city search",className:"input-weather"})),r.a.createElement("h3",null,"Total found: ",d.length," "),w.length>0&&d.length!==w.length?r.a.createElement("img",{src:"https://media.giphy.com/media/l31p1SkNXGz3l1nwwu/giphy.gif",alt:"loading",className:"loading-gif"}):r.a.createElement("div",{className:"all-weather-container"},d.map((function(e,n){return r.a.createElement("div",{className:"each-weather",key:e.res.woeid},r.a.createElement("div",{className:"each-container"},!0===a?r.a.createElement(m.a,{className:"weather-button weather-save",variant:"outlined",color:"secondary",onClick:function(){!function(e){var t=[].concat(Object(i.a)(j),[e]);N(t);var a=j.filter((function(t){return t!==e}));setTimeout((function(){N(a)}),3500)}(n),function(e,a){var n={name:e.res.title,weathers:e,newID:a._id};t(n)}(e,o)}},j.includes(n)?"Saved":"Add"):r.a.createElement("div",null,"Please login to save cities!"),r.a.createElement("br",null),r.a.createElement("h3",{className:"each-weather-title",variant:"h3",component:"h3"},e.res.title),r.a.createElement("h6",null,e.res.timezone),r.a.createElement("h6",null,"Time: ",e.res.time.slice(11,16)),r.a.createElement("hr",null),r.a.createElement(h.a,{interval:0},r.a.createElement(h.a.Item,null,r.a.createElement("h6",null,"Today"),r.a.createElement("img",{className:"weather-image",src:"https://www.metaweather.com/static/img/weather/".concat(e.res.consolidated_weather[0].weather_state_abbr,".svg"),alt:"weather state"}),r.a.createElement("h6",null,e.res.consolidated_weather[0].weather_state_name),r.a.createElement("h6",null,e.res.consolidated_weather[0].the_temp&&e.res.consolidated_weather[0].the_temp.toFixed(1)),r.a.createElement("h6",null,"Predictability:"," ",e.res.consolidated_weather[0].predictability&&e.res.consolidated_weather[0].predictability,"%")),e.res.consolidated_weather.map((function(t,a){return r.a.createElement(h.a.Item,{className:"show-more-each",key:a},0===a?r.a.createElement("h6",null,"Tomorrow"):r.a.createElement("h6",null,(o=e.res.consolidated_weather[a].applicable_date,["Mon","Tue","Wed","Thur","Fri","Sat","Sund"][new Date(o).getDay()])," ",parseInt(e.res.consolidated_weather[a].applicable_date.slice(8,10))<10?e.res.consolidated_weather[a].applicable_date.slice(9,10):e.res.consolidated_weather[a].applicable_date.slice(8,10)," ",(n=e.res.consolidated_weather[a].applicable_date,["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"][new Date(n).getMonth()])),r.a.createElement("img",{className:"weather-image",src:"https://www.metaweather.com/static/img/weather/".concat(e.res.consolidated_weather[a].weather_state_abbr,".svg"),alt:"weather state"}),r.a.createElement("h6",null,e.res.consolidated_weather[a].weather_state_name),r.a.createElement("h6",null,e.res.consolidated_weather[a].the_temp&&e.res.consolidated_weather[a].the_temp.toFixed(1),"C"),r.a.createElement("h6",null,"Predictability:"," ",e.res.consolidated_weather[a].predictability&&e.res.consolidated_weather[a].predictability,"%"));var n,o})))))}))))})),_=a(32),O=a(18),S=a(154),j=a(155),N=a(75),I=a.n(N),C=a(77),T=a.n(C),R=a(76),L=a.n(R),A=a(78),D=a.n(A),k=a(79),M=a.n(k),G=a(25),U=a(26),F=a(28),x=a(27),q=a(30),J=function(e){function t(){return Object(G.a)(this,t),Object(F.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(q.a)(t,e),Object(U.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Nearby cities"),r.a.createElement("p",null,"See cities nearby to you"))}}]),t}(n.Component),P=a(39),H=a(156),W=function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",email:"",password:"",msg:null},a.handleChange=function(e){a.setState(Object(P.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault();var t=a.state,n={name:t.name,email:t.email,password:t.password};a.props.register(n,a.props.history)},a}return Object(q.a)(t,e),Object(U.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.error;t!==e.error&&(t&&"REGISTER_FAIL"===t.id?this.setState({msg:t.msg.msg}):this.setState({msg:null}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{noValidate:!0,onSubmit:this.handleSubmit},r.a.createElement("div",{className:"register-container"},r.a.createElement("h1",null,"Register"),this.state.msg?r.a.createElement("span",{className:"red-text"},this.state.msg):null,r.a.createElement(H.a,{required:!0,id:"register-name",label:"Name Required",className:"my-form",margin:"normal",variant:"outlined",name:"name",onChange:this.handleChange,autoComplete:"on"}),r.a.createElement(H.a,{required:!0,id:"register-email",label:"Email Required",className:"my-form",margin:"normal",variant:"outlined",name:"email",onChange:this.handleChange,autoComplete:"on"}),r.a.createElement(H.a,{required:!0,id:"register-password",label:"Password Required",className:"my-form",type:"password",autoComplete:"current-password",margin:"normal",variant:"outlined",name:"password",onChange:this.handleChange}),r.a.createElement(m.a,{className:"my-btn",variant:"contained",color:"primary",type:"submit"},"Register"))))}}]),t}(n.Component),z=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,error:e.error}}),{register:function(e,t){var a=e.name,n=e.email,r=e.password;return function(e){var o=JSON.stringify({name:a,email:n,password:r});E.a.post("/api/users",o,{headers:{"Content-type":"application/json"}}).then((function(t){return e({type:"REGISTER_SUCCESS",payload:t.data})})).then((function(e){return t.push("/login")})).catch((function(t){e({type:"REGISTER_FAIL"}),e(g(t.response.data,t.response.status,"REGISTER_FAIL"))}))}}})(Object(_.g)(W)),V=function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).onLogoutClick=function(e){e.preventDefault(),a.props.logoutUser()},a.onLogout=function(){a.props.logout()},a.onDeleteClick=function(e){a.props.deleteItem(e)},a.onHandleShow=function(e){a.props.handleShow(e)},a}return Object(q.a)(t,e),Object(U.a)(t,[{key:"componentDidMount",value:function(){this.props.getItems()}},{key:"render",value:function(){var e=this;var t=this.props.item.items,a=this.props.auth.user,n=this.props.auth.isAuthenticated;return r.a.createElement("div",{className:"container"},!0===n?r.a.createElement("div",{className:"dashboard-weather-container"},r.a.createElement(m.a,{variant:"outlined",color:"primary",className:"logout-button",onClick:this.onLogout},"Log me out"),r.a.createElement("h1",null,"Hi ",a.name),r.a.createElement("p",null,"This is your dashboard"),r.a.createElement("div",{className:"all-weather-container"},t.map((function(t,n){var o=t.weathers,l=t._id;return t.newID===a._id?o&&r.a.createElement("div",{className:"each-weather",key:l},r.a.createElement("div",{className:"each-container"},r.a.createElement(m.a,{className:"weather-button weather-delete",variant:"outlined",color:"secondary",onClick:function(){return e.onDeleteClick(l)}},"Delete from list"),r.a.createElement("br",null),r.a.createElement("h3",{className:"each-weather-title"},o[0].res.title&&o[0].res.title),r.a.createElement("h6",null,"Timezone: ",o[0].res.timezone),r.a.createElement("h6",null,"Time: ",o[0].res.time.slice(11,16)),r.a.createElement("h6",null,"Temperature:"," ",o[0].res.consolidated_weather[0].the_temp&&o[0].res.consolidated_weather[0].the_temp.toFixed(1)," ","degrees celcius"),r.a.createElement(h.a,{interval:0},r.a.createElement(h.a.Item,null,r.a.createElement("h6",null,"Today"),r.a.createElement("img",{className:"weather-image",src:"https://www.metaweather.com/static/img/weather/".concat(o[0].res.consolidated_weather[0].weather_state_abbr,".svg"),alt:"weather state"}),r.a.createElement("h6",null,o[0].res.consolidated_weather[0].weather_state_name),r.a.createElement("h6",null,o[0].res.consolidated_weather[0].the_temp&&o[0].res.consolidated_weather[0].the_temp.toFixed(1)),r.a.createElement("h6",null,"Predictability:"," ",o[0].res.consolidated_weather[0].predictability&&o[0].res.consolidated_weather[0].predictability,"%")),o[0].res.consolidated_weather&&o[0].res.consolidated_weather.map((function(e,t){return r.a.createElement(h.a.Item,{className:"show-more-each",key:t},0===t?r.a.createElement("h6",null,"Tomorrow"):r.a.createElement("h6",null,(n=e.applicable_date,["Mon","Tue","Wed","Thur","Fri","Sat","Sund"][new Date(n).getDay()])," ",parseInt(e.applicable_date.slice(8,10))<10?e.applicable_date.slice(9,10):e.applicable_date.slice(8,10)," ",(a=e.applicable_date,["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"][new Date(a).getMonth()])),r.a.createElement("img",{className:"weather-image",src:"https://www.metaweather.com/static/img/weather/".concat(e.weather_state_abbr,".svg"),alt:"weather state"}),r.a.createElement("h6",null,e.weather_state_name),r.a.createElement("h6",null,e.the_temp&&e.the_temp.toFixed(1),"C"),r.a.createElement("h6",null,"Predictability:"," ",e.predictability&&e.predictability,"%"));var a,n}))))):null})))):r.a.createElement("div",null,r.a.createElement("h1",null,"Hi guest!"),r.a.createElement("p",null,"This is your dashboard, please login to view")))}}]),t}(n.Component),X=Object(d.b)((function(e){return{item:e.item,auth:e.auth}}),{getItems:function(){return function(e){e(v()),E.a.get("/api/items").then((function(t){return e({type:"GET_ITEMS",payload:t.data})})).catch((function(t){return e(g(t.response.data,t.response.status))}))}},deleteItem:function(e){return function(t,a){E.a.delete("/api/items/".concat(e),f(a)).then((function(a){return t({type:"DELETE_ITEM",payload:e})})).catch((function(e){return t(g(e.response.data,e.response.status))}))}},handleShow:function(e){return{type:"SHOW_MORE",payload:e}},logout:b})(V),B=a(21),Y=a(74),$=a(16),K={items:[{showMore:!1}],loading:!1},Q={token:localStorage.getItem("token"),isAuthenticated:null,isLoading:!1,user:[{_id:"2"}]},Z=Object(B.c)({item:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ITEMS":return Object($.a)({},e,{items:t.payload,loading:!1});case"DELETE_ITEM":return Object($.a)({},e,{items:e.items.filter((function(e){return e._id!==t.payload}))});case"ADD_ITEM":return Object($.a)({},e,{items:[t.payload].concat(Object(i.a)(e.items))});case"ITEMS_LOADING":return Object($.a)({},e,{loading:!0});case"SHOW_MORE":return Object($.a)({},e,{items:e.items.map((function(e){return e._id===t.payload?Object($.a)({},e,{showMore:!e.showMore}):e}))});default:return e}},error:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"GET_ERRORS":return{msg:e.payload.msg,status:e.payload.status,id:e.payload.id};case"CLEAR_ERRORS":return{msg:{},status:null,id:null};default:return null}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOADING":return Object($.a)({},e,{isLoading:!0});case"USER_LOADED":return Object($.a)({},e,{isAuthenticated:!0,isLoading:!1,user:t.payload});case"LOGIN_SUCCESS":case"REGISTER_SUCCESS":return localStorage.setItem("token",t.payload.token),Object($.a)({},e,{},t.payload,{isAuthenticated:!0,isLoading:!1});case"AUTH_ERROR":case"LOGIN_FAIL":case"LOGOUT_SUCCESS":case"REGISTER_FAIL":return localStorage.removeItem("token"),Object($.a)({},e,{token:null,user:null,isAuthenticated:!1,isLoading:!1});default:return e}}}),ee=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||B.d,te=Object(B.e)(Z,{},Object(B.d)(ee(Object(B.a)(Y.a)))),ae=function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(F.a)(this,(e=Object(x.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:"",msg:null},a.onLogout=function(){a.props.logout()},a.handleChange=function(e){a.setState(Object(P.a)({},e.target.name,e.target.value))},a.onSubmit=function(e){e.preventDefault();var t=a.state,n={email:t.email,password:t.password};a.props.login(n,a.props.history),a.props.loadUser()},a}return Object(q.a)(t,e),Object(U.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.error;t!==e.error&&(t&&"LOGIN_FAIL"===t.id?this.setState({msg:t.msg.msg}):this.setState({msg:null}))}},{key:"render",value:function(){var e=this.props.auth.user;return r.a.createElement("div",null,this.props.isAuthenticated?r.a.createElement("div",null,r.a.createElement("h1",null,"Hi ",e.name,", you are logged in!"),r.a.createElement(m.a,{variant:"outlined",color:"primary",className:"logout-button",onClick:this.onLogout},"Log me out")):r.a.createElement("div",null,r.a.createElement("form",{noValidate:!0,onSubmit:this.onSubmit},r.a.createElement("div",{className:"register-container"},r.a.createElement("h1",null,"Login"),this.state.msg?r.a.createElement("span",{className:"red-text"},this.state.msg):null,r.a.createElement(H.a,{required:!0,id:"register-email",label:"Email Required",className:"my-form",margin:"normal",variant:"outlined",name:"email",onChange:this.handleChange,autoComplete:"on"}),r.a.createElement(H.a,{required:!0,id:"register-password",label:"Password Required",className:"my-form",type:"password",autoComplete:"current-password",margin:"normal",variant:"outlined",name:"password",onChange:this.handleChange}),r.a.createElement(m.a,{className:"my-btn",variant:"contained",color:"primary",type:"submit"},"Login")))))}}]),t}(n.Component),ne=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,error:e.error,auth:e.auth}}),{login:function(e,t){var a=e.email,n=e.password;return function(e){var r=JSON.stringify({email:a,password:n});E.a.post("/api/auth",r,{headers:{"Content-type":"application/json"}}).then((function(t){return e({type:"LOGIN_SUCCESS",payload:t.data})})).then((function(e){return t.push("/")})).catch((function(t){e({type:"LOGIN_FAIL"}),e(g(t.response.data,t.response.status,"LOGIN_FAIL"))}))}},loadUser:w,logout:b})(Object(_.g)(ae));a(122);var re=function(){var e=r.a.useState(0),t=Object(c.a)(e,2),a=t[0],o=t[1];Object(n.useEffect)((function(){te.dispatch(w())}),[]);var l=Object(_.f)(),i=Object(_.e)();return console.log(l),console.log(i),r.a.createElement(d.a,{store:te},r.a.createElement(O.a,null,r.a.createElement("div",{className:"app-container"},r.a.createElement(S.a,{value:a,onChange:function(e,t){o(t)},showLabels:!0,className:"navbar"},r.a.createElement(j.a,{component:O.b,to:"/",value:"",label:"Saved Cities",icon:r.a.createElement(I.a,null)}),r.a.createElement(j.a,{component:O.b,value:"search",to:"/search",label:"Weather Search",icon:r.a.createElement(L.a,null)}),r.a.createElement(j.a,{component:O.b,to:"/nearby",value:"nearby",label:"Nearby",icon:r.a.createElement(T.a,null)}),r.a.createElement(j.a,{component:O.b,to:"/login",value:"login",label:"Login",icon:r.a.createElement(D.a,null)}),r.a.createElement(j.a,{component:O.b,to:"/register",value:"register",label:"Register",icon:r.a.createElement(M.a,null)})),r.a.createElement(_.a,{path:"/search",component:y}),r.a.createElement(_.a,{path:"/nearby",component:J}),r.a.createElement(_.a,{path:"/register",component:z}),r.a.createElement(_.a,{path:"/login",component:ne}),r.a.createElement(_.a,{path:"/",exact:!0,component:X}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(O.a,null,r.a.createElement(re,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},91:function(e,t,a){e.exports=a(124)},96:function(e,t,a){},97:function(e,t,a){}},[[91,1,2]]]);
//# sourceMappingURL=main.674b96a4.chunk.js.map